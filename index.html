<!DOCTYPE html>
<!-- saved from url=(0049)file:///C:/workspace/html_start-master/index.html -->
<html lang="ko"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ğŸ¦Š My Digital Wallet</title>

  <!-- ì´ë”ë¦¬ì›€ ë„¤íŠ¸ì›Œí¬ì™€ ìƒí˜¸ì‘ìš©í•˜ëŠ” JS ë¼ì´ë¸ŒëŸ¬ë¦¬ -->
  <script src="./ğŸ¦Š My Digital Wallet_files/web3.min.js.ë‹¤ìš´ë¡œë“œ"></script>
  <!-- í…ìŠ¤íŠ¸(ì£¼ì†Œ ë“±)ë¥¼ QR ì½”ë“œë¡œ ìƒì„±í•  ë•Œ ì‚¬ìš© -->
  <script src="./ğŸ¦Š My Digital Wallet_files/qrcode.min.js.ë‹¤ìš´ë¡œë“œ"></script>
  <script src="./ğŸ¦Š My Digital Wallet_files/jquery-latest.js.ë‹¤ìš´ë¡œë“œ"></script>
  <!-- íŠ¸ëœì­ì…˜ ê°ì²´ë¥¼ ìƒì„±í•˜ê³  ì„œëª…í•˜ëŠ” ë° í•„ìš”í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ -->
  <script type="text/javascript" src="./ğŸ¦Š My Digital Wallet_files/ethereumjs-tx-1.3.3.min.js"></script>

  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      max-width: 800px;
      margin: 40px auto;
      padding: 20px;
      border-radius: 12px;
      background-color: #f8f9fa;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    }

    input[type="text"], input[type="password"] {
      width: 95%;
      padding: 10px;
      margin: 6px 0 16px 0;
      border: 1px solid #ccc;
      border-radius: 8px;
      font-size: 16px;
    }

    textarea {
      width: 95%;
      height: 120px;
      padding: 10px;
      font-size: 15px;
      border: 1px solid #aaa;
      border-radius: 8px;
      margin-bottom: 20px;
      resize: vertical;
    }

    button {
      padding: 10px 18px;
      margin: 5px 5px 15px 0;
      font-size: 16px;
      border: none;
      border-radius: 8px;
      background-color: #007bff;
      color: white;
      cursor: pointer;
    }

    button:hover {
      background-color: #0056b3;
    }

    #qrModal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      display: none;
      justify-content: center;
      align-items: center;
    }

    #qrContent {
      background: white;
      padding: 20px;
      border-radius: 16px;
      text-align: center;
    }

    body.dark-mode {
      background-color: #1e1e1e;
      color: #f0f0f0;
    }

    body.dark-mode input,
    body.dark-mode textarea {
      background-color: #2c2c2c;
      color: white;
      border-color: #555;
    }

    body.dark-mode button {
      background-color: #3399ff;
    }

    body.dark-mode button:hover {
      background-color: #237acc;
    }

    .dark-mode-toggle {
      position: fixed;
      top: 20px;
      right: 20px;
      padding: 8px 14px;
      font-size: 14px;
      background-color: #444;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      z-index: 999;
    }

    .dark-mode-toggle:hover {
      background-color: #666;
    }

    #addressBook {
      margin-top: 30px;
    }

    #addressBook ul {
      padding-left: 20px;
      list-style: none;
    }

    #addressBook li {
      margin: 5px 0;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: space-between;
      background-color: #e9ecef;
      padding: 6px 12px;
      border-radius: 8px;
      transition: background-color 0.2s ease;
    }

    #addressBook li:hover {
      background-color: #ced4da;
    }

    #addressBook li span {
      flex-grow: 1;
      flex-shrink: 0;
      min-width: 250px;
      user-select: none;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    /* ë³µì‚¬ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
    #addressBook li button.copy-btn {
      flex-shrink: 0;
      width: 60px;
      margin-left: 10px;
      padding: 4px 8px;
      font-size: 12px;
      background-color: #28a745;
      border: none;
      border-radius: 6px;
      color: white;
      cursor: pointer;
    }

    #addressBook li button.copy-btn:hover {
      background-color: #218838;
    }

    /* ì‚­ì œ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
    #addressBook li button.delete-btn {
      flex-shrink: 0;
      width: 60px;
      margin-left: 10px;
      padding: 4px 8px;
      font-size: 12px;
      background-color: #dc3545;
      border: none;
      border-radius: 6px;
      color: white;
      cursor: pointer;
    }

    #addressBook li button.delete-btn:hover {
      background-color: #c82333;
    }

    /* ì„¤ëª…ì„œ ëª¨ë‹¬ ìŠ¤íƒ€ì¼ ì¶”ê°€ */
    #guideModal {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.5);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }
    #guideContent {
      background: white;
      border-radius: 16px;
      padding: 30px;
      max-width: 600px;
      max-height: 80%;
      overflow-y: auto;
      font-size: 16px;
      line-height: 1.5;
      color: #333;
    }
    #guideContent h3 {
      margin-top: 0;
      margin-bottom: 15px;
    }
    #guideContent ul {
      padding-left: 20px;
    }
    #guideContent ul li {
      margin-bottom: 12px;
    }
    #guideContent button {
      margin-top: 20px;
      background-color: #007bff;
      border: none;
      color: white;
      padding: 8px 18px;
      border-radius: 8px;
      cursor: pointer;
    }
    #guideContent button:hover {
      background-color: #0056b3;
    }
  </style>
</head>

<body>
  <h2>ğŸ¦Š My Digital Wallet</h2>
  <button class="dark-mode-toggle" onclick="toggleDarkMode()">ğŸŒ™ í…Œë§ˆ ì „í™˜</button>

  <label>ì†¡ì‹ ì²˜:</label><br>
  <input type="text" id="fromAddress" maxlength="60"><br>

  <label>ê°œì¸í‚¤:</label><br>
  <input type="password" id="privateKey" maxlength="66"><br>

  <label>ìˆ˜ì‹ ì²˜:</label><br>
  <input type="text" id="toAddress" maxlength="60"><br>

  <label>ê¸ˆì•¡:</label><br>
  <input type="text" id="amount" maxlength="20"><br>

  <label>ë©”ì‹œì§€:</label><br>
  <textarea id="message" readonly=""></textarea><br>

  <button onclick="createAccount()">ê³„ì • ìƒì„±</button>
  <button onclick="getBalance()">Sepolia ì”ì•¡ ì¡°íšŒ</button>
  <button onclick="getQuantumBalance()">í€€í…€ ì”ì•¡ ì¡°íšŒ</button>

  <button onclick="sendTransaction()">Sepolia ì „ì†¡</button>
  <button onclick="sendQuantumToken()">í€€í…€ ì „ì†¡</button>
  
  <button onclick="generateQRCode()">QR ì½”ë“œ ìƒì„±</button>


  <!-- ì£¼ì†Œë¶ ì¶”ê°€ ì…ë ¥ì°½ -->
  <h3>ğŸ“’ ì£¼ì†Œë¶ ì €ì¥</h3>
  <label>ë‹‰ë„¤ì„:</label><br>
  <input type="text" id="nickname" maxlength="20"><br>
  <label>ì£¼ì†Œ:</label><br>
  <input type="text" id="addressInput" maxlength="60"><br>
  <button onclick="saveAddressBook()">ì£¼ì†Œë¶ì— ì €ì¥</button>

  <!-- ì£¼ì†Œë¶ í‘œì‹œ -->
  <div id="addressBook">
    <h4>ğŸ“– ì €ì¥ëœ ì£¼ì†Œë“¤:</h4>
    <ul id="addressList"></ul>
  </div>

  <!-- QR ëª¨ë‹¬ -->
  <div id="qrModal">
    <div id="qrContent">
      <div id="qrcode"></div>
      <button onclick="closeQR()">ë‹«ê¸°</button>
    </div>
  </div>

  <!-- ì„¤ëª…ì„œ ë²„íŠ¼ ë° ëª¨ë‹¬ ì¶”ê°€ -->
  <button style="position: fixed; top: 70px; right: 20px; padding: 8px 14px; font-size: 14px; border-radius: 8px; background-color:#444; color:#fff; border:none; cursor:pointer; z-index:999;" onclick="openGuide()">ğŸ“˜ ì‚¬ìš© ì„¤ëª…ì„œ</button>

  <div id="guideModal">
    <div id="guideContent">
      <h3>ğŸ“˜ ì‚¬ìš© ì„¤ëª…ì„œ</h3>
      <ul>
        <li><strong>ì‹œì‘í•˜ê¸° ì „</strong>: 'ë©”íƒ€ë§ˆìŠ¤í¬'ë¼ëŠ” ì•±ì„ ê¹”ì•„ì•¼í•©ë‹ˆë‹¤. ì´ë•Œ, ì•„ì´ë””ì™€ ë¹„ë°€í‚¤ëŠ” 'ê³„ì •ìƒì„±'ì˜ ë„ì›€ì„ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. í˜„ì¬ ì´ ì‚¬ì´íŠ¸ëŠ” í…ŒìŠ¤íŠ¸ ë„¤íŠ¸ì›Œí¬ì¸ sepoliaë¥¼ ì´ìš©í•©ë‹ˆë‹¤.</li>
        <li><strong>ê³„ì • ìƒì„±</strong>: ìƒˆë¡œìš´ ì§€ê°‘ ì£¼ì†Œì™€ ê°œì¸í‚¤ë¥¼ ë§Œë“­ë‹ˆë‹¤.</li>
        <li><strong>Sepolia/í€€í…€ ì”ì•¡ ì¡°íšŒ</strong>: ì…ë ¥í•œ ì£¼ì†Œì˜ Sepolia/í€€í…€ í† í° ì”ì•¡ì„ í™•ì¸í•©ë‹ˆë‹¤.</li>
        <li><strong>Sepolia/í€€í…€ ì „ì†¡</strong>: ë°›ëŠ” ì£¼ì†Œ, ê¸ˆì•¡, ê°œì¸í‚¤ë¥¼ ì…ë ¥í•˜ì—¬ Sepolia/í€€í…€ í† í°ì„ ì „ì†¡í•©ë‹ˆë‹¤.</li>
        <li><strong>QR ì½”ë“œ ìƒì„±</strong>: ë‚´ ì£¼ì†Œë¥¼ QR ì½”ë“œë¡œ ë§Œë“¤ì–´ ì‰½ê²Œ ê³µìœ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
        <li><strong>ì£¼ì†Œë¶ ì €ì¥</strong>: ìì£¼ ì“°ëŠ” ì£¼ì†Œë¥¼ ë‹‰ë„¤ì„ê³¼ í•¨ê»˜ ì €ì¥í•˜ê³  ì‰½ê²Œ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
        <li><strong>í…Œë§ˆ ì „í™˜</strong>: ë°ì€ ëª¨ë“œì™€ ì–´ë‘ìš´ ëª¨ë“œë¥¼ ì „í™˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
      </ul>
      <button onclick="closeGuide()">ë‹«ê¸°</button>
    </div>
  </div>

  <script>
    // web3 ì¸ìŠ¤í„´ìŠ¤ë¥¼ Sepolia í…ŒìŠ¤íŠ¸ë„· Infura ë…¸ë“œì— ì—°ê²°í•´ ë§Œë“¤ê¸°
    const web3 = new Web3("https://sepolia.infura.io/v3/50473e2dece547e8a00e72a271ffa10f");

    // ê³„ì • ìƒì„± í•¨ìˆ˜
    async function createAccount() {
      // ê³„ì • ìƒì„± í•¨ìˆ˜
      const account = web3.eth.accounts.create();
      // ì…ë ¥ì°½ì— ì£¼ì†Œí™” ë¹„ë°€í‚¤ ë„£ê¸°
      document.getElementById("fromAddress").value = account.address;
      document.getElementById("privateKey").value = account.privateKey;
      // ë©”ì„¸ì§€ ì°½ì— ì£¼ì†Œì™€ ë¹„ë°€í‚¤ ì¶œë ¥
      document.getElementById("message").value += `\nâœ… ê³„ì • ìƒì„±ë¨:\nì£¼ì†Œ: ${account.address}\në¹„ë°€í‚¤: ${account.privateKey}\n`;
      // íŒì—…ì°½ì— ë¬¸êµ¬ ì¶œë ¥
      alert("ê³„ì •ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤: " + account.address);
    }

    // ì”ì•¡ ì¡°íšŒ í•¨ìˆ˜
    async function getBalance() {
      // ì…ë ¥ì°½ì— ì‚¬ìš©ìê°€ ì…ë ¥í•œ ì£¼ì†Œë¥¼ addressì— ì €ì¥
      const address = document.getElementById("fromAddress").value.trim();
      // ì˜¬ë°”ë¥¸ ì´ë”ë¦¬ì›€ ì£¼ì†Œì¸ì§€ ê²€ì‚¬
      if (!web3.utils.isAddress(address)) {
        document.getElementById("message").value += "â— ìœ íš¨í•œ ì£¼ì†Œë¥¼ ì…ë ¥í•˜ì„¸ìš”.\n";
        return;
      }
      // ì£¼ì†Œì˜ ì´ë”ë¦¬ì›€ ì”ì•¡ ê°€ì ¸ì˜¤ê¸°
      const balance = await web3.eth.getBalance(address);
      // ê²°ê³¼ëŠ” wei ë‹¨ìœ„(1 ETH = 1,000,000,000,000,000,000 wei)ë¡œ ë‚˜ì˜¤ê¸° ë•Œë¬¸ì— ETH ë‹¨ìœ„ë¡œ ë°”ê¿”ì£¼ê¸°
      const ether = web3.utils.fromWei(balance, "ether");
      // ë©”ì„¸ì§€ ì°½ì— í˜„ì¬ ì”ì•¡ ì¶œë ¥
      document.getElementById("message").value += `ğŸ’° í˜„ì¬ ì”ì•¡: ${ether} ETH\n`;
    }

    // ì´ë” ì „ì†¡ í•¨ìˆ˜
    async function sendTransaction() {
      // ì…ë ¥ëœ ê°’ë“¤(ë³´ë‚´ëŠ” ì£¼ì†Œ, ë¹„ë°€í‚¤, ë°›ëŠ” ì£¼ì†Œ, ë³´ë‚¼ ê¸ˆì•¡)ì„ ì „ë¶€ ì½ì–´ì˜¤ê¸°
      const from = document.getElementById("fromAddress").value.trim();
      const privateKey = document.getElementById("privateKey").value.trim();
      const to = document.getElementById("toAddress").value.trim();
      const amount = document.getElementById("amount").value.trim();

      // ì˜¬ë°”ë¥¸ ì´ë”ë¦¬ì›€ ì£¼ì†Œì¸ì§€ ë‘˜ ë‹¤ ê²€ì‚¬
      if (!web3.utils.isAddress(from) || !web3.utils.isAddress(to)) {
        document.getElementById("message").value += "â— ì£¼ì†Œê°€ ìœ íš¨í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.\n";
        return;
      }

      try {
        // ì§€ê¸ˆê¹Œì§€ ëª‡ ê°œì˜ íŠ¸ëœì­ì…˜ì„ ë³´ëƒˆëŠ”ì§€ ì„¸ê¸°
        const txCount = await web3.eth.getTransactionCount(from);

        // í¸ì§€ë´‰íˆ¬ ê°™ì€ ëŠë‚Œ
        const txObject = {
          nonce: web3.utils.toHex(txCount), // ëª‡ ë²ˆì§¸ íŠ¸ëœì­ì…˜ì¸ì§€
          to: to, // ë°›ì„ ì‚¬ëŒ ì£¼ì†Œ
          value: web3.utils.toHex(web3.utils.toWei(amount, "ether")), // ë³´ë‚¼ ê¸ˆì•¡ (ETH -> wei)
          gasLimit: web3.utils.toHex(21000), // ì´ë” ì „ì†¡ì„ ìœ„í•œ ìˆ˜ìˆ˜ë£Œ
          gasPrice: web3.utils.toHex(web3.utils.toWei("10", "gwei")), // ì „ì†¡í•˜ëŠ” ëŒ€ì‹  ë„¤íŠ¸ì›Œí¬ì—ê²Œ ì£¼ëŠ” ìˆ˜ìˆ˜ë£Œ
        };

        const Tx = ethereumjs.Tx;
        const Buffer = ethereumjs.Buffer.Buffer;
        // íŠ¸ëœì­ì…˜ ê°œì²´ë¡œ ë§Œë“¤ê¸°
        const tx = new Tx(txObject);
        // í”„ë¼ì´ë¹— í‚¤ë¥¼ ì´ìš©í•´ ì„œëª…
        tx.sign(Buffer.from(privateKey.replace(/^0x/, ""), "hex"));

        // ë¬¸ìì—´ë¡œ ë³€í™˜
        const serializedTx = tx.serialize();
        const raw = "0x" + serializedTx.toString("hex");

        // íŠ¸ëœì ì…˜ ì „ì†¡
        const txHash = await web3.eth.sendSignedTransaction(raw);
        // ì„±ê³µ ë©”ì„¸ì§€ ì¶œë ¥
        document.getElementById("message").value += `âœ… ì „ì†¡ ì„±ê³µ!\níŠ¸ëœì­ì…˜ í•´ì‹œ: ${txHash.transactionHash}\n`;
      } catch (err) {
        document.getElementById("message").value += "âŒ ì „ì†¡ ì‹¤íŒ¨: " + err.message + "\n";
      }
    }

    // QR ì½”ë“œ ìƒì„± í•¨ìˆ˜
    function generateQRCode() {
      // fromAddressì— ì…ë ¥ëœ ê°’ ê°€ì ¸ì˜¤ê¸° & ê³µë°± ì œê±°
      const address = document.getElementById("fromAddress").value.trim();
      // ì´ë”ë¦¬ì›€ ì£¼ì†Œ í˜•ì‹ì´ ì•„ë‹ ê²½ìš° ì˜¤ë¥˜ ì¶œë ¥ & ì¢…ë£Œ
      if (!web3.utils.isAddress(address)) {
        document.getElementById("message").value += "â— ìœ íš¨í•œ ì´ë”ë¦¬ì›€ ì£¼ì†Œê°€ ì•„ë‹™ë‹ˆë‹¤.\n";
        return;
      }

      // QRì½”ë“œ í‘œì‹œí•  ì˜ì—­ ì´ˆê¸°í™”
      const qrDiv = document.getElementById("qrcode");
      qrDiv.innerHTML = "";

      // ì£¼ì†Œë¥¼ ê¸°ë°˜ìœ¼ë¡œ QR ì½”ë“œ ìƒì„±
      QRCode.toCanvas(address, { width: 400 }, function (error, canvas) {
        if (error) {
          document.getElementById("message").value += "âŒ QR ì½”ë“œ ìƒì„± ì‹¤íŒ¨\n";
        } else {
          qrDiv.appendChild(canvas);
          document.getElementById("qrModal").style.display = "flex";
        }
      });
    }

    // QR ì½”ë“œ ì°½ ë‹«ê¸°
    function closeQR() {
      document.getElementById("qrModal").style.display = "none";
    }

    // ë‹¤í¬ëª¨ë“œ
    function toggleDarkMode() {
      // ë‹¤í¬ëª¨ë“œ í´ë˜ìŠ¤ë¥¼ í† ê¸€(ìˆìœ¼ë©´ ì œê±°, ì—†ìœ¼ë©´ ì¶”ê°€)
      document.body.classList.toggle("dark-mode");
      const isDark = document.body.classList.contains("dark-mode");
      localStorage.setItem("theme", isDark ? "dark" : "light");
      // ëª¨ë“œ ìƒíƒœë¥¼ localStorageì— ì €ì¥
    }

    // í˜ì´ì§€ë¥¼ ì²˜ìŒ ë¡œë“œí•  ë•Œ, ë‹¤í¬ëª¨ë“œ ì„¤ì •ì´ ìˆë‹¤ë©´ ìë™ìœ¼ë¡œ ì ìš©
    if (localStorage.getItem("theme") === "dark") {
      document.body.classList.add("dark-mode");
    }

    // ì£¼ì†Œë¡ ì €ì¥ í•¨ìˆ˜
    function saveAddressBook() {
      const nickname = document.getElementById("nickname").value.trim();
      const address = document.getElementById("addressInput").value.trim();

      if (!nickname || !web3.utils.isAddress(address)) {
        alert("ë‹‰ë„¤ì„ê³¼ ìœ íš¨í•œ ì£¼ì†Œë¥¼ ì…ë ¥í•˜ì„¸ìš”.");
        return;
      }

      const book = JSON.parse(localStorage.getItem("addressBook") || "{}");
      book[nickname] = address;
      localStorage.setItem("addressBook", JSON.stringify(book));
      renderAddressBook();
      document.getElementById("nickname").value = "";
      document.getElementById("addressInput").value = "";
    }

    // ì£¼ì†Œë¡ ë Œë”ë§ í•¨ìˆ˜
    function renderAddressBook() {
      const book = JSON.parse(localStorage.getItem("addressBook") || "{}");
      const list = document.getElementById("addressList");
      list.innerHTML = "";

      for (const name in book) {
        const li = document.createElement("li");

        const span = document.createElement("span");
        span.textContent = `${name}: ${book[name]}`;
        span.title = book[name]; // ì „ì²´ ì£¼ì†Œ íˆ´íŒ ì œê³µ
        li.appendChild(span);

        // ë³µì‚¬ ë²„íŠ¼
        const copyBtn = document.createElement("button");
        copyBtn.textContent = "ë³µì‚¬";
        copyBtn.className = "copy-btn";
        copyBtn.onclick = () => {
          navigator.clipboard.writeText(book[name]).then(() => {
            alert("ì£¼ì†Œê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.");
          });
        };
        li.appendChild(copyBtn);

        // ì‚­ì œ ë²„íŠ¼
        const delBtn = document.createElement("button");
        delBtn.textContent = "ì‚­ì œ";
        delBtn.className = "delete-btn";
        delBtn.onclick = () => {
          if (confirm(`ì •ë§ '${name}' ì£¼ì†Œë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
            delete book[name];
            localStorage.setItem("addressBook", JSON.stringify(book));
            renderAddressBook();
          }
        };
        li.appendChild(delBtn);

        // í´ë¦­ ì‹œ ì£¼ì†Œ ì…ë ¥ë€ì— ì±„ìš°ê¸°
        span.onclick = () => {
          document.getElementById("toAddress").value = book[name];
        };

        list.appendChild(li);
      }
    }

    // ì´ˆê¸° ë¡œë“œ ì‹œ ì£¼ì†Œë¡ ë Œë”ë§
    renderAddressBook();

    // ì‚¬ìš© ì„¤ëª…ì„œ ëª¨ë‹¬ ì—´ê¸°
    function openGuide() {
      document.getElementById("guideModal").style.display = "flex";
    }
    // ì‚¬ìš© ì„¤ëª…ì„œ ëª¨ë‹¬ ë‹«ê¸°
    function closeGuide() {
      document.getElementById("guideModal").style.display = "none";
    }

    // í€€í…€(Qutu) í† í° ì»¨íŠ¸ë™íŠ¸ ì£¼ì†Œ (Sepolia ë„¤íŠ¸ì›Œí¬)
    const quantumTokenAddress = "0xA98f25cCCcb54bcF046cb5DF8e0Fb161B04ce04c";

    // ERC-20 í† í° í‘œì¤€ ABI (ì”ì•¡ ì¡°íšŒ, ì „ì†¡ì— í•„ìš”í•œ ìµœì†Œí•œì˜ ABI)
    const erc20Abi = [
      {
        "constant": true,
        "inputs": [{ "name": "account", "type": "address" }],
        "name": "balanceOf",
        "outputs": [{ "name": "", "type": "uint256" }],
        "type": "function"
      },
      {
        "constant": false,
        "inputs": [
          { "name": "to", "type": "address" },
          { "name": "amount", "type": "uint256" }
        ],
        "name": "transfer",
        "outputs": [{ "name": "", "type": "bool" }],
        "type": "function"
      },
      {
        "constant": true,
        "inputs": [],
        "name": "decimals",
        "outputs": [{ "name": "", "type": "uint8" }],
        "type": "function"
      }
    ];

    // í† í° ì»¨íŠ¸ë™íŠ¸ ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
    const quantumContract = new web3.eth.Contract(erc20Abi, quantumTokenAddress);

    // í€€í…€ ì”ì•¡ ì¡°íšŒ í•¨ìˆ˜
    async function getQuantumBalance() {
      const address = document.getElementById("fromAddress").value.trim();
      if (!web3.utils.isAddress(address)) {
        document.getElementById("message").value += "â— ìœ íš¨í•œ ì£¼ì†Œë¥¼ ì…ë ¥í•˜ì„¸ìš”.\n";
        return;
      }
      try {
        const decimals = await quantumContract.methods.decimals().call();
        const balanceRaw = await quantumContract.methods.balanceOf(address).call();
        const balance = balanceRaw / (10 ** decimals);
        document.getElementById("message").value += `ğŸ”· í€€í…€ ì”ì•¡: ${balance} Qutu\n`;
      } catch (err) {
        document.getElementById("message").value += "âŒ í€€í…€ ì”ì•¡ ì¡°íšŒ ì‹¤íŒ¨: " + err.message + "\n";
      }
    }

    // í€€í…€ í† í° ì „ì†¡ í•¨ìˆ˜
    async function sendQuantumToken() {
      const from = document.getElementById("fromAddress").value.trim();
      const privateKey = document.getElementById("privateKey").value.trim();
      const to = document.getElementById("toAddress").value.trim();
      const amount = document.getElementById("amount").value.trim();

      if (!web3.utils.isAddress(from) || !web3.utils.isAddress(to)) {
        document.getElementById("message").value += "â— ì£¼ì†Œê°€ ìœ íš¨í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.\n";
        return;
      }

      if (!amount || isNaN(amount) || Number(amount) <= 0) {
        document.getElementById("message").value += "â— ì˜¬ë°”ë¥¸ í† í° ìˆ˜ëŸ‰ì„ ì…ë ¥í•˜ì„¸ìš”.\n";
        return;
      }

      try {
        const decimals = await quantumContract.methods.decimals().call();
        const tokenAmount = web3.utils.toBN(Number(amount) * (10 ** decimals));
        const txCount = await web3.eth.getTransactionCount(from);

        const data = quantumContract.methods.transfer(to, tokenAmount.toString()).encodeABI();

        const gasLimit = 100000;
        const gasPrice = await web3.eth.getGasPrice();

        const txObject = {
          nonce: web3.utils.toHex(txCount),
          to: quantumTokenAddress,
          value: "0x0",
          gasLimit: web3.utils.toHex(gasLimit),
          gasPrice: web3.utils.toHex(gasPrice),
          data: data,
          chainId: 11155111 // Sepolia ì²´ì¸ ID
        };

        const Tx = ethereumjs.Tx;
        const Buffer = ethereumjs.Buffer.Buffer;
        const tx = new Tx(txObject, { chain: 'sepolia' });
        tx.sign(Buffer.from(privateKey.replace(/^0x/, ""), "hex"));

        const serializedTx = tx.serialize();
        const raw = "0x" + serializedTx.toString("hex");

        const receipt = await web3.eth.sendSignedTransaction(raw);
        document.getElementById("message").value += `âœ… í€€í…€ ì „ì†¡ ì„±ê³µ!\níŠ¸ëœì­ì…˜ í•´ì‹œ: ${receipt.transactionHash}\n`;
      } catch (err) {
        document.getElementById("message").value += "âŒ í€€í…€ ì „ì†¡ ì‹¤íŒ¨: " + err.message + "\n";
      }
    }
  </script>


</body></html>